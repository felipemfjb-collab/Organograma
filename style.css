*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root{
  --cream:#FAF7F2; --dark:#1A1A2E; --accent:#C8853A;
  --accent-light:#F0D5B5; --border:#E2D9CE; --border-strong:#C9B9A7;
  --text:#2C2C3E; --sub:#7A7A8C; --green:#2D6A4F; --green-light:#EAF4F0;
  --asst:#4A7FC1; --asst-light:#D6E6F7;

  --surface:#ffffff;
  --shadow: 0 4px 40px rgba(0,0,0,0.06);
}

body{
  font-family:'DM Sans',sans-serif;
  background:var(--cream);
  color:var(--text);
  min-height:100vh;
}

body.dark{
  --cream:#0f111a;
  --surface:#141827;
  --text:#E8E9F1;
  --sub:#A7A9BE;
  --border:#2b2f44;
  --border-strong:#3a3f59;
  --shadow: 0 4px 40px rgba(0,0,0,0.35);
}

header{
  background:var(--dark);
  color:white;
  padding:16px 22px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:14px;
  position:sticky; top:0; z-index:100;
  box-shadow:0 2px 20px rgba(0,0,0,0.2);
}

.brand{ display:flex; align-items:center; gap:10px; }
header h1{ font-family:'DM Serif Display',serif; font-size:1.4rem; }
.badge{
  font-size:.72rem; background:var(--accent);
  padding:3px 10px; border-radius:20px;
  font-weight:800; letter-spacing:.03em;
}

.toolbar{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
.toolbar-divider{ width:1px; height:32px; background:rgba(255,255,255,0.25); margin:0 4px; }

.btn{
  padding:8px 14px;
  border:none; border-radius:10px;
  font-family:'DM Sans',sans-serif;
  font-size:.83rem;
  font-weight:700;
  cursor:pointer;
  display:inline-flex;
  align-items:center;
  gap:7px;
  transition:.2s;
  white-space:nowrap;
}
.btn:disabled{ opacity:.5; cursor:not-allowed; transform:none!important; }

.btn-accent{ background:var(--accent); color:white; }
.btn-accent:hover{ background:#a86b28; transform:translateY(-1px); }

.btn-green{ background:var(--green); color:white; }
.btn-green:hover{ background:#1e4d37; transform:translateY(-1px); }

.btn-outline{
  background:transparent;
  color:white;
  border:1.5px solid rgba(255,255,255,0.28);
}
.btn-outline:hover{ background:rgba(255,255,255,0.08); }

.btn-outline-dark{
  background:transparent;
  color:var(--text);
  border:1.5px solid var(--border-strong);
}
.btn-outline-dark:hover{
  border-color:var(--accent);
  color:var(--accent);
}

.main{ padding:30px 22px; }

.upload-section{ max-width:720px; margin:0 auto; }
.instructions{
  background:var(--surface);
  border-radius:16px;
  border:1px solid var(--border);
  padding:24px 26px;
  margin-bottom:18px;
  box-shadow:var(--shadow);
}

.instructions h3{
  font-family:'DM Serif Display',serif;
  font-size:1.2rem;
  margin-bottom:14px;
}

.step{ display:flex; gap:12px; margin-bottom:12px; align-items:flex-start; }
.step-num{
  background:var(--accent); color:white;
  border-radius:50%; width:26px; height:26px;
  display:flex; align-items:center; justify-content:center;
  font-size:.78rem; font-weight:900; flex-shrink:0; margin-top:2px;
}
.step p{ font-size:.87rem; line-height:1.55; color:var(--text); }

code{
  background:var(--accent-light);
  padding:1px 7px; border-radius:4px;
  font-size:.82rem; font-weight:900; color:var(--dark);
}

.info-box{
  background:#EEF4FF;
  border:1px solid #C0D4F0;
  border-radius:12px;
  padding:12px 14px;
  margin-top:12px;
  font-size:.85rem;
  color:#2A4A7F;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
}

.warn-box{
  margin-top:12px;
  background:#fff3cd;
  border:1px solid #ffe69c;
  border-radius:12px;
  padding:12px 14px;
  color:#7a5a00;
  font-size:.86rem;
}
.warn-box ul{ margin-top:8px; padding-left:18px; }
.warn-box li{ margin:4px 0; }

.download-tpl{
  display:inline-flex; align-items:center; gap:6px;
  color:var(--accent); font-weight:800; font-size:.85rem;
  cursor:pointer; border:none; background:none; padding:0;
  margin-top:12px; text-decoration:underline; text-underline-offset:3px;
}

.upload-zone{
  border:2.5px dashed var(--border);
  border-radius:20px;
  background:var(--surface);
  padding:46px 30px;
  text-align:center;
  cursor:pointer;
  transition:.3s;
  box-shadow:var(--shadow);
}
.upload-zone:hover,.upload-zone.drag{ border-color:var(--accent); background:#FDF5EA; }
.upload-zone h2{
  font-family:'DM Serif Display',serif;
  font-size:1.5rem;
  margin-bottom:8px;
}
.upload-zone p{ color:var(--sub); font-size:.88rem; }
#fileInput{ display:none; }

/* CHART */
.status-bar{ display:flex; gap:14px; align-items:center; flex-wrap:wrap; margin-bottom:14px; }
.stat{
  background:var(--surface); border:1px solid var(--border);
  border-radius:10px; padding:9px 14px; font-size:.84rem;
  box-shadow:var(--shadow);
}
.stat strong{ color:var(--accent); font-size:1.1rem; margin-right:4px; }
.tip{
  background:var(--green-light); border:1px solid #C3E0D4;
  border-radius:10px; padding:9px 14px; font-size:.82rem;
  color:var(--green); margin-left:auto;
}

/* FILTERS */
.filters-bar{
  background:var(--surface);
  border:1px solid var(--border);
  border-radius:14px;
  padding:12px 16px;
  margin-bottom:12px;
  display:flex;
  gap:12px;
  align-items:center;
  flex-wrap:wrap;
  box-shadow:var(--shadow);
}
.filter-group{ display:flex; flex-direction:column; gap:4px; min-width:160px; }
.filter-label{ font-size:.72rem; font-weight:900; color:var(--sub); text-transform:uppercase; letter-spacing:.05em; }
.filter-input{
  padding:6px 10px; border:1.5px solid var(--border);
  border-radius:10px; font-family:'DM Sans',sans-serif;
  font-size:.84rem; color:var(--text);
  background:var(--cream); outline:none;
}
.filter-input:focus{ border-color:var(--accent); }
.filter-divider{ width:1px; height:40px; background:var(--border); margin:0 2px; }
.filter-btn{
  padding:6px 14px; border:1.5px solid var(--border);
  border-radius:10px; font-family:'DM Sans',sans-serif;
  font-size:.82rem; font-weight:800;
  cursor:pointer; background:var(--surface); color:var(--sub);
  transition:.2s; white-space:nowrap;
}
.filter-btn:hover{ border-color:var(--accent); color:var(--accent); }
.search-wrap{ position:relative; }
.search-wrap svg{ position:absolute; left:9px; top:50%; transform:translateY(-50%); color:var(--sub); pointer-events:none; }
.search-wrap .filter-input{ padding-left:30px; }

/* Legend + chart */
.legend{ display:flex; gap:18px; align-items:center; margin-bottom:10px; font-size:.8rem; color:var(--sub); flex-wrap:wrap; }
.legend-item{ display:flex; align-items:center; gap:7px; }
.leg-box{ width:22px; height:14px; border-radius:4px; }

.chart-wrap{
  background:var(--surface);
  border-radius:16px;
  border:1px solid var(--border);
  padding:26px 18px;
  overflow:auto;
  box-shadow:var(--shadow);
  cursor:grab;
  user-select:none;
  height: calc(100vh - 320px);
  min-height: 420px;
}
.chart-wrap.dragging{ cursor:grabbing; }

#orgChart{
  display:inline-flex;
  flex-direction:column;
  align-items:center;
  min-width:100%;
  transform-origin: top left;
}

/* Nodes */
.node{
  background:rgba(255,255,255,0.98);
  border:2px solid var(--border-strong);
  border-radius:12px;
  padding:10px 16px;
  min-width:150px;
  max-width:230px;
  text-align:center;
  box-shadow:0 2px 12px rgba(0,0,0,0.07);
  transition:box-shadow .2s, transform .2s;
  position:relative;
}
body.dark .node{ background:rgba(20,24,39,0.95); }

.node:hover{ box-shadow:0 8px 26px rgba(200,133,58,0.22); transform:translateY(-2px); }

.node-name{ font-weight:800; font-size:.87rem; color:var(--text); line-height:1.25; margin-bottom:6px; }
.node-role{
  font-size:.69rem; font-weight:900;
  background:var(--accent-light); color:var(--accent);
  border-radius:6px; padding:3px 10px;
  display:inline-block;
  text-transform:uppercase;
  letter-spacing:.05em;
}
.node.root{ border:2px solid var(--accent); }
.node.root .node-role{ background:var(--accent); color:white; }

.node.assistant{ border:2px dashed var(--asst); }
.node.assistant .node-role{ background:var(--asst-light); color:var(--asst); }

.v-line{ width:2px; background:var(--accent); margin:0 auto; }

/* Collapse btn */
.node .collapse-btn{
  position:absolute; bottom:-13px; left:50%; transform:translateX(-50%);
  width:26px; height:26px; border-radius:50%;
  background:var(--accent); color:white; border:2px solid white;
  font-size:.78rem; cursor:pointer;
  display:flex; align-items:center; justify-content:center;
  font-weight:900; z-index:10; line-height:1; padding:0;
  box-shadow:0 1px 5px rgba(0,0,0,0.2);
  transition:box-shadow .15s, transform .15s;
}
.node .collapse-btn:hover{
  transform:translateX(-50%) scale(1.15);
  box-shadow:0 3px 10px rgba(200,133,58,0.4);
}

/* Search highlight */
.node.highlighted{ border:2px solid #F5A623!important; box-shadow:0 0 0 3px rgba(245,166,35,0.3)!important; }
.node.dimmed{ opacity:.18; }
/* Caminho ancestral até o nó encontrado */
.node.ancestor-path{
  border:2px solid var(--accent)!important;
  box-shadow:0 0 0 3px rgba(200,133,58,0.2)!important;
  background: #FDF5EA !important;
}
/* Membros de team-box */
.team-box-member.highlighted-member{
  background: rgba(245,166,35,0.25);
  border-radius: 6px;
  margin: 0 -4px;
  padding: 5px 4px;
}
.team-box-member.dimmed-member{ opacity:.25; }
.team-box.dimmed-box{ opacity:.2; }
/* Contador de equipe no header */
.node-count{
  font-size:.65rem;
  color:var(--sub);
  margin-top:5px;
  font-weight:700;
  letter-spacing:.02em;
}


/* ASSISTENTES: à direita do gestor, na mesma linha horizontal */
.assistants-below{
  display:flex;
  flex-direction:row;
  align-items:center;
  gap:0;
}

/* Team box */
.team-box{
  border-radius:12px; overflow:hidden;
  min-width:180px; max-width:260px;
  box-shadow:0 4px 16px rgba(0,0,0,0.13);
}
.team-box-header{
  background:#1e4d37;
  color:white;
  padding:7px 12px;
  font-size:.72rem;
  font-weight:900;
  text-transform:uppercase;
  letter-spacing:.07em;
  text-align:center;
}
.team-box-body{ background:var(--green); padding:10px 12px; }
.team-box-member{
  display:flex; align-items:center; gap:8px;
  color:white; font-size:.79rem;
  padding:5px 0;
  border-bottom:1px solid rgba(255,255,255,0.16);
}
.team-box-member:last-child{ border-bottom:none; }
.team-box-member .num{ font-size:.68rem; opacity:.65; min-width:16px; font-weight:900; }

/* Zoom UI */
.zoom-box{ display:flex; align-items:center; gap:10px; padding:6px 10px; border-radius:12px; border:1px solid rgba(255,255,255,0.2); }
.zoom-pill{ font-weight:900; font-size:.78rem; color:#fff; opacity:.95; min-width:44px; text-align:right; }
.zoom-range{ width:140px; }

.node.flash{ box-shadow:0 0 0 4px rgba(200,133,58,0.25); }